{
  "info": {
    "name": "Colombian Real Estate Tokenization API",
    "description": "Collection for testing the tokenized real estate investment platform with WhatsApp integration",
    "schema": "https://schema.getpostman.com/json/collection/v2.1.0/collection.json"
  },
  "variable": [
    {
      "key": "base_url",
      "value": "http://localhost:3000",
      "type": "string"
    },
    {
      "key": "colombian_user1",
      "value": "+573001234567",
      "type": "string"
    },
    {
      "key": "colombian_user2",
      "value": "+573129876543",
      "type": "string"
    },
    {
      "key": "colombian_user3",
      "value": "+573208765432",
      "type": "string"
    },
    {
      "key": "property_id",
      "value": "16418-M4614094",
      "type": "string"
    }
  ],
  "item": [
    {
      "name": "Property API Tests",
      "item": [
        {
          "name": "Get All Properties",
          "request": {
            "method": "GET",
            "header": [],
            "url": {
              "raw": "{{base_url}}/api/properties?limit=5",
              "host": ["{{base_url}}"],
              "path": ["api", "properties"],
              "query": [
                {
                  "key": "limit",
                  "value": "5"
                }
              ]
            }
          }
        },
        {
          "name": "Search Properties by Neighborhood",
          "request": {
            "method": "GET",
            "header": [],
            "url": {
              "raw": "{{base_url}}/api/properties?neighborhood=Centro&limit=3",
              "host": ["{{base_url}}"],
              "path": ["api", "properties"],
              "query": [
                {
                  "key": "neighborhood",
                  "value": "Centro"
                },
                {
                  "key": "limit",
                  "value": "3"
                }
              ]
            }
          }
        },
        {
          "name": "Search Properties by Price Range",
          "request": {
            "method": "GET",
            "header": [],
            "url": {
              "raw": "{{base_url}}/api/properties?minPrice=200000000&maxPrice=400000000&limit=5",
              "host": ["{{base_url}}"],
              "path": ["api", "properties"],
              "query": [
                {
                  "key": "minPrice",
                  "value": "200000000"
                },
                {
                  "key": "maxPrice", 
                  "value": "400000000"
                },
                {
                  "key": "limit",
                  "value": "5"
                }
              ]
            }
          }
        },
        {
          "name": "Get Property Details",
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"propertyId\": \"{{property_id}}\"\n}"
            },
            "url": {
              "raw": "{{base_url}}/api/properties",
              "host": ["{{base_url}}"],
              "path": ["api", "properties"]
            }
          }
        }
      ]
    },
    {
      "name": "WhatsApp Real Estate Agent",
      "item": [
        {
          "name": "Initial Investment Interest - User 1",
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"userMessage\": \"Quiero ver oportunidades de inversión\",\n  \"phoneNumber\": \"{{colombian_user1}}\",\n  \"createNewWallet\": true\n}"
            },
            "url": {
              "raw": "{{base_url}}/api/agent",
              "host": ["{{base_url}}"],
              "path": ["api", "agent"]
            }
          }
        },
        {
          "name": "Ask for Properties in Centro",
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"userMessage\": \"Muéstrame propiedades en el barrio Centro\",\n  \"phoneNumber\": \"{{colombian_user1}}\"\n}"
            },
            "url": {
              "raw": "{{base_url}}/api/agent",
              "host": ["{{base_url}}"],
              "path": ["api", "agent"]
            }
          }
        },
        {
          "name": "Ask About Property Investment",
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"userMessage\": \"¿Cuánto necesito para invertir en la propiedad {{property_id}}?\",\n  \"phoneNumber\": \"{{colombian_user1}}\"\n}"
            },
            "url": {
              "raw": "{{base_url}}/api/agent",
              "host": ["{{base_url}}"],
              "path": ["api", "agent"]
            }
          }
        },
        {
          "name": "Investment Calculation",
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"userMessage\": \"Quiero invertir 2 millones de pesos en esa propiedad\",\n  \"phoneNumber\": \"{{colombian_user1}}\"\n}"
            },
            "url": {
              "raw": "{{base_url}}/api/agent",
              "host": ["{{base_url}}"],
              "path": ["api", "agent"]
            }
          }
        },
        {
          "name": "Check Wallet Balance",
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"userMessage\": \"¿Cuál es el saldo de mi billetera?\",\n  \"phoneNumber\": \"{{colombian_user1}}\"\n}"
            },
            "url": {
              "raw": "{{base_url}}/api/agent",
              "host": ["{{base_url}}"],
              "path": ["api", "agent"]
            }
          }
        },
        {
          "name": "New User Onboarding - User 2",
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"userMessage\": \"Hola, soy nuevo y quiero invertir en bienes raíces\",\n  \"phoneNumber\": \"{{colombian_user2}}\",\n  \"createNewWallet\": true\n}"
            },
            "url": {
              "raw": "{{base_url}}/api/agent",
              "host": ["{{base_url}}"],
              "path": ["api", "agent"]
            }
          }
        }
      ]
    },
    {
      "name": "WhatsApp Webhook Tests",
      "item": [
        {
          "name": "Webhook Verification",
          "request": {
            "method": "GET",
            "header": [],
            "url": {
              "raw": "{{base_url}}/api/whatsapp?hub.mode=subscribe&hub.verify_token=tu_token_de_verificacion&hub.challenge=test_challenge",
              "host": ["{{base_url}}"],
              "path": ["api", "whatsapp"],
              "query": [
                {
                  "key": "hub.mode",
                  "value": "subscribe"
                },
                {
                  "key": "hub.verify_token",
                  "value": "tu_token_de_verificacion"
                },
                {
                  "key": "hub.challenge",
                  "value": "test_challenge"
                }
              ]
            }
          }
        },
        {
          "name": "WhatsApp Message - Investment Interest",
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"entry\": [{\n    \"changes\": [{\n      \"value\": {\n        \"messages\": [{\n          \"from\": \"{{colombian_user1}}\",\n          \"text\": {\"body\": \"Quiero ver oportunidades de inversión\"},\n          \"type\": \"text\"\n        }]\n      }\n    }]\n  }]\n}"
            },
            "url": {
              "raw": "{{base_url}}/api/whatsapp",
              "host": ["{{base_url}}"],
              "path": ["api", "whatsapp"]
            }
          }
        },
        {
          "name": "WhatsApp Message - Property Inquiry",
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"entry\": [{\n    \"changes\": [{\n      \"value\": {\n        \"messages\": [{\n          \"from\": \"{{colombian_user1}}\",\n          \"text\": {\"body\": \"Muéstrame propiedades en Centro con menos de 250 millones\"},\n          \"type\": \"text\"\n        }]\n      }\n    }]\n  }]\n}"
            },
            "url": {
              "raw": "{{base_url}}/api/whatsapp",
              "host": ["{{base_url}}"],
              "path": ["api", "whatsapp"]
            }
          }
        }
      ]
    },
    {
      "name": "Wallet Management",
      "item": [
        {
          "name": "List All Wallets",
          "request": {
            "method": "GET",
            "header": [],
            "url": {
              "raw": "{{base_url}}/api/wallets",
              "host": ["{{base_url}}"],
              "path": ["api", "wallets"]
            }
          }
        },
        {
          "name": "Get User 1 Wallet",
          "request": {
            "method": "GET",
            "header": [],
            "url": {
              "raw": "{{base_url}}/api/wallets?phoneNumber={{user1_phone}}",
              "host": ["{{base_url}}"],
              "path": ["api", "wallets"],
              "query": [
                {
                  "key": "phoneNumber",
                  "value": "{{user1_phone}}"
                }
              ]
            }
          }
        },
        {
          "name": "Get User 2 Wallet",
          "request": {
            "method": "GET",
            "header": [],
            "url": {
              "raw": "{{base_url}}/api/wallets?phoneNumber={{user2_phone}}",
              "host": ["{{base_url}}"],
              "path": ["api", "wallets"],
              "query": [
                {
                  "key": "phoneNumber",
                  "value": "{{user2_phone}}"
                }
              ]
            }
          }
        },
        {
          "name": "Delete User 3 Wallet",
          "request": {
            "method": "DELETE",
            "header": [],
            "url": {
              "raw": "{{base_url}}/api/wallets?phoneNumber={{user3_phone}}",
              "host": ["{{base_url}}"],
              "path": ["api", "wallets"],
              "query": [
                {
                  "key": "phoneNumber",
                  "value": "{{user3_phone}}"
                }
              ]
            }
          }
        }
      ]
    },
    {
      "name": "Error Testing",
      "item": [
        {
          "name": "Invalid Phone Number",
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"userMessage\": \"Hello\",\n  \"phoneNumber\": \"invalid-phone\"\n}"
            },
            "url": {
              "raw": "{{base_url}}/api/agent",
              "host": ["{{base_url}}"],
              "path": ["api", "agent"]
            }
          }
        },
        {
          "name": "Get Non-existent Wallet",
          "request": {
            "method": "GET",
            "header": [],
            "url": {
              "raw": "{{base_url}}/api/wallets?phoneNumber=+9999999999",
              "host": ["{{base_url}}"],
              "path": ["api", "wallets"],
              "query": [
                {
                  "key": "phoneNumber",
                  "value": "+9999999999"
                }
              ]
            }
          }
        }
      ]
    }
  ]
}
